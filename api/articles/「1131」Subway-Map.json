{"title":"「1131」Subway Map","uid":"841d996290522367bb59c54f717d9310","slug":"「1131」Subway-Map","date":"2022-11-24T14:20:00.000Z","updated":"2022-11-24T14:49:10.309Z","comments":true,"path":"api/articles/「1131」Subway-Map.json","keywords":null,"cover":[],"content":"<p>In the big cities, the subway systems always look so complex to the visitors. To give you some sense, the following figure shows the map of Beijing subway. Now you are supposed to help people with your computer skills! Given the starting position of your user, your task is to find the quickest way to his&#x2F;her destination.</p>\n<p><img src=\"https://images.ptausercontent.com/55799c23-4bdb-4e32-af7f-6d41accfdd2b.jpg\" alt=\"subwaymap.jpg\"></p>\n<span id=\"more\"></span>\n\n<h3><span id=\"input-specification\">Input Specification:</span></h3><p>Each input file contains one test case. For each case, the first line contains a positive integer N (≤ 100), the number of subway lines. Then N lines follow, with the i-th (i&#x3D;1,⋯,N) line describes the i-th subway line in the format:</p>\n<p>M S[1] S[2] … S[M]</p>\n<p>where M (≤ 100) is the number of stops, and S[i]’s (i&#x3D;1,⋯,M) are the indices of the stations (the indices are 4-digit numbers from 0000 to 9999) along the line. It is guaranteed that the stations are given in the correct order – that is, the train travels between S[i] and S[i+1] (i&#x3D;1,⋯,M−1) without any stop.</p>\n<p>Note: It is possible to have loops, but not self-loop (no train starts from S and stops at S without passing through another station). Each station interval belongs to a unique subway line. Although the lines may cross each other at some stations (so called “transfer stations”), no station can be the conjunction of more than 5 lines.</p>\n<p>After the description of the subway, another positive integer K (≤ 10) is given. Then K lines follow, each gives a query from your user: the two indices as the starting station and the destination, respectively.</p>\n<p>The following figure shows the sample map.</p>\n<p><img src=\"https://images.ptausercontent.com/932c8f1b-7dd5-489d-a774-a91c1fabba7f.jpg\" alt=\"samplemap.jpg\"></p>\n<p>Note: It is guaranteed that all the stations are reachable, and all the queries consist of legal station numbers.</p>\n<h3><span id=\"output-specification\">Output Specification:</span></h3><p>For each query, first print in a line the minimum number of stops. Then you are supposed to show the optimal path in a friendly format as the following:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Take Line#X1 from S1 to S2.</span><br><span class=\"line\">Take Line#X2 from S2 to S3.</span><br><span class=\"line\">......</span><br></pre></td></tr></table></figure>\n\n<p>where <code>X</code>i’s are the line numbers and <code>S</code>i’s are the station indices. Note: Besides the starting and ending stations, only the transfer stations shall be printed.</p>\n<p>If the quickest path is not unique, output the one with the minimum number of transfers, which is guaranteed to be unique.</p>\n<h3><span id=\"sample-input\">Sample Input:</span></h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">4</span><br><span class=\"line\">7 1001 3212 1003 1204 1005 1306 7797</span><br><span class=\"line\">9 9988 2333 1204 2006 2005 2004 2003 2302 2001</span><br><span class=\"line\">13 3011 3812 3013 3001 1306 3003 2333 3066 3212 3008 2302 3010 3011</span><br><span class=\"line\">4 6666 8432 4011 1306</span><br><span class=\"line\">3</span><br><span class=\"line\">3011 3013</span><br><span class=\"line\">6666 2001</span><br><span class=\"line\">2004 3001</span><br></pre></td></tr></table></figure>\n\n<h3><span id=\"sample-output\">Sample Output:</span></h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">2</span><br><span class=\"line\">Take Line#3 from 3011 to 3013.</span><br><span class=\"line\">10</span><br><span class=\"line\">Take Line#4 from 6666 to 1306.</span><br><span class=\"line\">Take Line#3 from 1306 to 2302.</span><br><span class=\"line\">Take Line#2 from 2302 to 2001.</span><br><span class=\"line\">6</span><br><span class=\"line\">Take Line#2 from 2004 to 1204.</span><br><span class=\"line\">Take Line#1 from 1204 to 1306.</span><br><span class=\"line\">Take Line#3 from 1306 to 3001.</span><br></pre></td></tr></table></figure>\n\n<hr>\n<h2><span id=\"ω\">Ω</span></h2><p>$\\qquad$勾八题目，死给你看哦。其实不是很难，但我一直陷在BFS，百思不得其解。</p>\n<p>$\\qquad$给出地铁站图中所有线路的站台编号，要求你输出给定起点和终点站台的路线。如需换乘则还需输出换乘站台。优先输出过站最少的路线，如果有多条路线则输出换乘数最少的路线。</p>\n<p>$\\qquad$一开始，我还尝试了Dijkstra，不禁超时而且只ac了两个测试点。于是乎，我改用BFS结果还是只ac了两个。如果PAT考试里遇到这题，我怕不是已经千疮百孔了。经过几百次抓狂之后，仔细分析了一波，我在BFS中用pre数组存储最优路线的前置节点，但事实上你不往后走是无法确定到某个节点的路线是最优的，因为你还不知道终点在哪个方向，所以你不知道在这个节点上是否需要换乘，不同路线到达这个站台的换乘次数就会不同。当然你可以找到所有起点到终点站台数最少的路线，然后再逐一计算换乘数，取最小者。</p>\n<p>$\\qquad$最后发现所有的方法都会回到DFS，只有DFS能直接计算出到终点站共换乘了多少次。设置一个全局最优pair对opt，如果到终点的路线比opt优则记录路线并更新opt，同时用pos表示这条路原本在几号线上，如果接下去将要dfs的站台线号与当前路线线号不同则给trans+1。o对，注意到每个站台可能属于多个线路，而邻站之间的路线则属于唯一线路，因此用<code>map&lt;pair&lt;int,int&gt;,int&gt;</code>表示相邻站台之间的路线属于哪一线路。</p>\n<hr>\n<h2><span id>🐎</span></h2><figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;iostream&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;vector&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;map&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\">map&lt;pair&lt;<span class=\"type\">int</span>, <span class=\"type\">int</span>&gt;, <span class=\"type\">int</span>&gt; line;</span><br><span class=\"line\">vector&lt;vector&lt;<span class=\"type\">int</span>&gt;&gt; <span class=\"built_in\">edge</span>(<span class=\"number\">10000</span>);</span><br><span class=\"line\"><span class=\"function\">vector&lt;<span class=\"type\">bool</span>&gt; <span class=\"title\">flag</span><span class=\"params\">(<span class=\"number\">10000</span>, <span class=\"literal\">false</span>)</span></span>;</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt; path, ans;</span><br><span class=\"line\">pair&lt;<span class=\"type\">int</span>, <span class=\"type\">int</span>&gt; opt&#123;INT32_MAX, INT32_MAX&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"type\">int</span> s, <span class=\"type\">int</span> e, <span class=\"type\">int</span> trans, <span class=\"type\">int</span> pos)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">static</span> <span class=\"type\">int</span> depth = <span class=\"number\">0</span>;</span><br><span class=\"line\">    flag[s] = <span class=\"literal\">true</span>, path.<span class=\"built_in\">push_back</span>(s);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (s == e)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"built_in\">make_pair</span>(depth, trans) &lt; opt)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            opt = <span class=\"built_in\">make_pair</span>(depth, trans);</span><br><span class=\"line\">            ans = path;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;k: edge[s])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (flag[k]) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            depth += <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"built_in\">dfs</span>(k, e, trans + (pos != line[&#123;k, s&#125;] &amp;&amp; depth &gt; <span class=\"number\">1</span>), line[&#123;k, s&#125;]);</span><br><span class=\"line\">            depth -= <span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    flag[s] = <span class=\"literal\">false</span>, path.<span class=\"built_in\">pop_back</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n, m, k, a, b, p;</span><br><span class=\"line\">    <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;n);</span><br><span class=\"line\">    edge.<span class=\"built_in\">resize</span>(<span class=\"number\">10000</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; ++i)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d %d&quot;</span>, &amp;m, &amp;p);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; j &lt; m; ++j)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;k);</span><br><span class=\"line\">            line[<span class=\"built_in\">make_pair</span>(k, p)] = line[<span class=\"built_in\">make_pair</span>(p, k)] = i + <span class=\"number\">1</span>;</span><br><span class=\"line\">            edge[k].<span class=\"built_in\">push_back</span>(p), edge[p].<span class=\"built_in\">push_back</span>(k);</span><br><span class=\"line\">            p = k;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;m);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; m; ++i)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d %d&quot;</span>, &amp;a, &amp;b);</span><br><span class=\"line\">        <span class=\"built_in\">dfs</span>(a, b, <span class=\"number\">0</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>, opt.first);</span><br><span class=\"line\">        <span class=\"type\">int</span> l = line[&#123;ans[<span class=\"number\">0</span>], ans[<span class=\"number\">1</span>]&#125;], p = a;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; j &lt; ans.<span class=\"built_in\">size</span>(); ++j)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (line[&#123;ans[j - <span class=\"number\">1</span>], ans[j]&#125;] != l)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;Take Line#%d from %04d to %04d.\\n&quot;</span>, l, p, ans[j - <span class=\"number\">1</span>]);</span><br><span class=\"line\">                l = line[&#123;ans[j - <span class=\"number\">1</span>], ans[j]&#125;], p = ans[j - <span class=\"number\">1</span>];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;Take Line#%d from %04d to %04d.\\n&quot;</span>, l, p, ans.<span class=\"built_in\">back</span>());</span><br><span class=\"line\">        path.<span class=\"built_in\">clear</span>(), ans.<span class=\"built_in\">clear</span>();</span><br><span class=\"line\">        opt = &#123;INT32_MAX, INT32_MAX&#125;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","text":"In the big cities, the subway systems always look so complex to the visitors. To give you some sense, the following figure shows the map of ...","link":"","photos":[],"count_time":{"symbolsCount":"5.5k","symbolsTime":"5 mins."},"categories":[{"name":"PAT（Advanced Level）Practice","slug":"PAT（Advanced-Level）Practice","count":153,"path":"api/categories/PAT（Advanced-Level）Practice.json"}],"tags":[{"name":"C＋＋","slug":"C＋＋","count":160,"path":"api/tags/C＋＋.json"},{"name":"Graph","slug":"Graph","count":16,"path":"api/tags/Graph.json"},{"name":"DFS","slug":"DFS","count":7,"path":"api/tags/DFS.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\"><span class=\"toc-text\">Input Specification:</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\"><span class=\"toc-text\">Output Specification:</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\"><span class=\"toc-text\">Sample Input:</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\"><span class=\"toc-text\">Sample Output:</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\"><span class=\"toc-text\">Ω</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\"><span class=\"toc-text\">🐎</span></a>","author":{"name":"Starlit Rover","slug":"blog-author","avatar":"https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcQWu4nWh5NV26rlAS5lR23iaundn5IVlV3EpYGNAdtnMObooQnk","link":"/","description":"Stroll in the starlit firmament~","socials":{"github":"https://github.com/StarlitRover","twitter":"https://twitter.com/Starlit_Rover","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"steam":{"icon":"/images/aurora/steam.svg","link":"https://steamcommunity.com/id/starlitrover/"}}}},"mapped":true,"prev_post":{"title":"『1132』Cut Integer","uid":"358e1bd298e98daf2cbd6662a57fb65a","slug":"『1132』Cut-Integer","date":"2022-11-24T16:28:21.000Z","updated":"2022-11-24T16:34:15.030Z","comments":true,"path":"api/articles/『1132』Cut-Integer.json","keywords":null,"cover":null,"text":"Cutting an integer means to cut a K digits lone integer Z into two integers of (K&#x2F;2) digits long integers A and B. For example, after c...","link":"","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[{"name":"PAT（Advanced Level）Practice","slug":"PAT（Advanced-Level）Practice","count":153,"path":"api/categories/PAT（Advanced-Level）Practice.json"}],"tags":[{"name":"C＋＋","slug":"C＋＋","count":160,"path":"api/tags/C＋＋.json"}],"author":{"name":"Starlit Rover","slug":"blog-author","avatar":"https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcQWu4nWh5NV26rlAS5lR23iaundn5IVlV3EpYGNAdtnMObooQnk","link":"/","description":"Stroll in the starlit firmament~","socials":{"github":"https://github.com/StarlitRover","twitter":"https://twitter.com/Starlit_Rover","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"steam":{"icon":"/images/aurora/steam.svg","link":"https://steamcommunity.com/id/starlitrover/"}}}}},"next_post":{"title":"『1130」Infix Expression","uid":"0def5409a91f0fbcec7f6cf9896df886","slug":"『1130」Infix-Expression","date":"2022-11-23T17:27:42.000Z","updated":"2022-11-25T06:58:03.937Z","comments":true,"path":"api/articles/『1130」Infix-Expression.json","keywords":null,"cover":[],"text":"Given a syntax tree (binary), you are supposed to output the corresponding infix expression, with parentheses reflecting the precedences of ...","link":"","photos":[],"count_time":{"symbolsCount":"2.5k","symbolsTime":"2 mins."},"categories":[{"name":"PAT（Advanced Level）Practice","slug":"PAT（Advanced-Level）Practice","count":153,"path":"api/categories/PAT（Advanced-Level）Practice.json"}],"tags":[{"name":"C＋＋","slug":"C＋＋","count":160,"path":"api/tags/C＋＋.json"},{"name":"traversal order","slug":"traversal-order","count":13,"path":"api/tags/traversal-order.json"},{"name":"Tree","slug":"Tree","count":23,"path":"api/tags/Tree.json"}],"author":{"name":"Starlit Rover","slug":"blog-author","avatar":"https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcQWu4nWh5NV26rlAS5lR23iaundn5IVlV3EpYGNAdtnMObooQnk","link":"/","description":"Stroll in the starlit firmament~","socials":{"github":"https://github.com/StarlitRover","twitter":"https://twitter.com/Starlit_Rover","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"steam":{"icon":"/images/aurora/steam.svg","link":"https://steamcommunity.com/id/starlitrover/"}}}}}}