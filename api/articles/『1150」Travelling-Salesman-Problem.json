{"title":"ã€1150ã€Travelling Salesman Problem","uid":"a4815f6ae46beab8c783f42705d05394","slug":"ã€1150ã€Travelling-Salesman-Problem","date":"2022-11-28T12:44:21.000Z","updated":"2022-12-02T15:17:27.740Z","comments":true,"path":"api/articles/ã€1150ã€Travelling-Salesman-Problem.json","keywords":null,"cover":null,"content":"<p>The â€œtravelling salesman problemâ€ asks the following question: â€œGiven a list of cities and the distances between each pair of cities, what is the shortest possible route that visits each city and returns to the origin city?â€ It is an NP-hard problem in combinatorial optimization, important in operations research and theoretical computer science. (Quoted from â€œ<a href=\"https://en.wikipedia.org/wiki/Travelling_salesman_problem\">https://en.wikipedia.org/wiki/Travelling_salesman_problem</a>â€œ.)</p>\n<p>In this problem, you are supposed to find, from a given list of cycles, the one that is the closest to the solution of a travelling salesman problem.</p>\n<span id=\"more\"></span>\n\n<h3><span id=\"input-specification\">Input Specification:</span></h3><p>Each input file contains one test case. For each case, the first line contains 2 positive integersÂ NÂ (2&lt;Nâ‰¤200), the number of cities, andÂ M, the number of edges in an undirected graph. ThenÂ MÂ lines follow, each describes an edge in the formatÂ <code>City1 City2 Dist</code>, where the cities are numbered from 1 toÂ NÂ and the distanceÂ <code>Dist</code>Â is positive and is no more than 100. The next line gives a positive integerÂ KÂ which is the number of paths, followed byÂ KÂ lines of paths, each in the format:</p>\n<p>nÂ C1â€‹Â C2â€‹Â â€¦Â Cnâ€‹</p>\n<p>whereÂ nÂ is the number of cities in the list, andÂ Ciâ€‹â€™s are the cities on a path.</p>\n<h3><span id=\"output-specification\">Output Specification:</span></h3><p>For each path, print in a lineÂ <code>Path X: TotalDist (Description)</code>Â whereÂ <code>X</code>Â is the index (starting from 1) of that path,Â <code>TotalDist</code>Â its total distance (if this distance does not exist, outputÂ <code>NA</code>Â instead), andÂ <code>Description</code>Â is one of the following:</p>\n<ul>\n<li><code>TS simple cycle</code>Â if it is a simple cycle that visits every city;</li>\n<li><code>TS cycle</code>Â if it is a cycle that visits every city, but not a simple cycle;</li>\n<li><code>Not a TS cycle</code>Â if it is NOT a cycle that visits every city.</li>\n</ul>\n<p>Finally print in a lineÂ <code>Shortest Dist(X) = TotalDist</code>Â whereÂ <code>X</code>Â is the index of the cycle that is the closest to the solution of a travelling salesman problem, andÂ <code>TotalDist</code>Â is its total distance. It is guaranteed that such a solution is unique.</p>\n<h3><span id=\"sample-input\">Sample Input:</span></h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">6 10</span><br><span class=\"line\">6 2 1</span><br><span class=\"line\">3 4 1</span><br><span class=\"line\">1 5 1</span><br><span class=\"line\">2 5 1</span><br><span class=\"line\">3 1 8</span><br><span class=\"line\">4 1 6</span><br><span class=\"line\">1 6 1</span><br><span class=\"line\">6 3 1</span><br><span class=\"line\">1 2 1</span><br><span class=\"line\">4 5 1</span><br><span class=\"line\">7</span><br><span class=\"line\">7 5 1 4 3 6 2 5</span><br><span class=\"line\">7 6 1 3 4 5 2 6</span><br><span class=\"line\">6 5 1 4 3 6 2</span><br><span class=\"line\">9 6 2 1 6 3 4 5 2 6</span><br><span class=\"line\">4 1 2 5 1</span><br><span class=\"line\">7 6 1 2 5 4 3 1</span><br><span class=\"line\">7 6 3 2 5 4 1 6</span><br></pre></td></tr></table></figure>\n\n<h3><span id=\"sample-output\">Sample Output:</span></h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Path 1: 11 (TS simple cycle)</span><br><span class=\"line\">Path 2: 13 (TS simple cycle)</span><br><span class=\"line\">Path 3: 10 (Not a TS cycle)</span><br><span class=\"line\">Path 4: 8 (TS cycle)</span><br><span class=\"line\">Path 5: 3 (Not a TS cycle)</span><br><span class=\"line\">Path 6: 13 (Not a TS cycle)</span><br><span class=\"line\">Path 7: NA (Not a TS cycle)</span><br><span class=\"line\">Shortest Dist(4) = 8</span><br></pre></td></tr></table></figure>\n\n<hr>\n<h2><span id=\"Ï‰\">Î©</span></h2><p>$\\qquad$TSPæ˜¯ä¸€ä¸ªNPéš¾é—®é¢˜ï¼Œè¿™ä¸€é¢˜éœ€è¦ä½ åˆ¤æ–­ç»™å®šæ— å‘å›¾ä¸­çš„ä¸€äº›è·¯å¾„æ˜¯ä»¥ä¸‹ä¸‰ç§ä¸­çš„å“ªç§ï¼š</p>\n<ol>\n<li><p>TS ç®€å•ç¯ï¼šæ¯åº§åŸå¸‚è®¿é—®è¿‡ä¸”ä»…è®¿é—®è¿‡ä¸€æ¬¡</p>\n</li>\n<li><p>TS ç¯ï¼šæ¯åº§åŸå¸‚éƒ½è®¿é—®è¿‡ï¼Œä½†éƒ¨åˆ†åŸå¸‚å¤šæ¬¡$(&gt;1)$è®¿é—®</p>\n</li>\n<li><p>éTSç¯ï¼šéƒ¨åˆ†åŸå¸‚æ²¡æœ‰è®¿é—®ï¼Œæˆ–æ ¹æœ¬ä¸æ˜¯ç¯ï¼Œæˆ–è·¯çº¿ä¸å­˜åœ¨</p>\n</li>\n</ol>\n<p>$\\qquad$æ³¨æ„å¦‚æœä¸æ˜¯è·¯çº¿ä¸å­˜åœ¨ï¼Œæ‰€æœ‰çš„è·¯çº¿éƒ½éœ€è¦è¾“å‡ºæ€»é•¿åº¦ï¼Œè€Œæœ€ä¼˜è·¯çº¿åªèƒ½ä»TS simple cycleå’ŒTS cycleä¸­é€‰ã€‚ç”¨ä¸€ä¸ª<code>bitset&lt;201&gt;</code>æ¥æ ‡è®°åŸå¸‚æ˜¯å¦è®¿é—®è¿‡ï¼Œç”¨æ•´å‹å˜é‡<code>jdg</code>çš„ä½ä¸¤ä½åˆ†åˆ«æ¥è¡¨ç¤ºå…·å¤‡TS cycleï¼ˆé‡å¤è®¿é—®åŸå¸‚ï¼‰å’ŒNot a TS cycleçš„ç‰¹å¾ï¼ˆæœ‰åŸå¸‚æ²¡è®¿é—®ã€ä¸æ˜¯ç¯è·¯ã€è·¯çº¿ä¸å­˜åœ¨ï¼‰ï¼Œæ˜¾ç„¶å½“$jdg&#x3D;(01)_2$æ—¶è¯´æ˜æ˜¯å‰è€…çš„æƒ…å†µï¼Œè€Œ$jdg&#x3D;(10)_2\\ \\mathrm{or}\\ jdg&#x3D;(11)_2$éƒ½æ˜¯åè€…ã€‚è¯»å…¥è·¯çº¿çš„è¿‡ç¨‹ä¸­ï¼Œåˆ¤æ–­æ˜¯å¦é‡å¤è®¿é—®ï¼ŒåŒæ—¶æ£€æŸ¥è·¯çº¿æ˜¯å¦å­˜åœ¨ã€‚è¯»å®Œä¹‹ååˆ¤æ–­èµ·ç‚¹å’Œç»ˆç‚¹æ˜¯å¦ç›¸åŒï¼Œæ˜¯å¦æ‰€æœ‰åŸå¸‚éƒ½å·²è®¿é—®ã€‚æœ€åæ ¹æ®jdgçš„å€¼è¾“å‡ºç›¸åº”çš„ä¿¡æ¯ã€‚</p>\n<hr>\n<h2><span id>ğŸ</span></h2><figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;iostream&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;vector&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bitset&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n, m, k, a, b, p, d = <span class=\"number\">0</span>, jdg = <span class=\"number\">0</span>, opt = <span class=\"number\">-1</span>, min_d = INT32_MAX;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    vector&lt;vector&lt;<span class=\"type\">int</span>&gt;&gt; <span class=\"built_in\">dist</span>(n + <span class=\"number\">1</span>, <span class=\"built_in\">vector</span>(n + <span class=\"number\">1</span>, <span class=\"number\">0</span>));</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; m; ++i)</span><br><span class=\"line\">        cin &gt;&gt; a &gt;&gt; b &gt;&gt; dist[b][a], dist[a][b] = dist[b][a];</span><br><span class=\"line\">    cin &gt;&gt; m;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; m; ++i, d = <span class=\"number\">0</span>, jdg = <span class=\"number\">0</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"function\">bitset&lt;201&gt; <span class=\"title\">flag</span><span class=\"params\">(string(n, <span class=\"string\">&#x27;1&#x27;</span>))</span></span>;</span><br><span class=\"line\">        cin &gt;&gt; k &gt;&gt; a, p = a;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; j &lt; k; ++j, p = b)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cin &gt;&gt; b;</span><br><span class=\"line\">            <span class=\"comment\">// if revisit city and visit non-existent road</span></span><br><span class=\"line\">            jdg |= !flag[b - <span class=\"number\">1</span>] + (dist[p][b] ? <span class=\"number\">0</span> : (d = <span class=\"number\">-1</span>, <span class=\"number\">2</span>));</span><br><span class=\"line\">            d += (d &gt; <span class=\"number\">-1</span>) * dist[p][b], flag[b - <span class=\"number\">1</span>] = <span class=\"literal\">false</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// if starting city is same as ending city and all the cities have been visited</span></span><br><span class=\"line\">        jdg |= (a == b &amp;&amp; flag == <span class=\"number\">0</span> ? <span class=\"number\">0</span> : <span class=\"number\">2</span>);</span><br><span class=\"line\">        <span class=\"keyword\">switch</span> (jdg)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"number\">0</span>:</span><br><span class=\"line\">                <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;Path %d: %d (TS simple cycle)\\n&quot;</span>, i + <span class=\"number\">1</span>, d);</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (d &lt; min_d) min_d = d, opt = i + <span class=\"number\">1</span>;</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"number\">1</span>:</span><br><span class=\"line\">                <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;Path %d: %d (TS cycle)\\n&quot;</span>, i + <span class=\"number\">1</span>, d);</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (d &lt; min_d) min_d = d, opt = i + <span class=\"number\">1</span>;</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">default</span>:</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (d &gt; <span class=\"number\">0</span>) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;Path %d: %d (Not a TS cycle)\\n&quot;</span>, i + <span class=\"number\">1</span>, d);</span><br><span class=\"line\">                <span class=\"keyword\">else</span> <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;Path %d: NA (Not a TS cycle)\\n&quot;</span>, i + <span class=\"number\">1</span>);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;Shortest Dist(%d) = %d&quot;</span>, opt, min_d);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","text":"The â€œtravelling salesman problemâ€ asks the following question: â€œGiven a list of cities and the distances between each pair of cities, what i...","link":"","photos":[],"count_time":{"symbolsCount":"4.5k","symbolsTime":"4 mins."},"categories":[{"name":"PATï¼ˆAdvanced Levelï¼‰Practice","slug":"PATï¼ˆAdvanced-Levelï¼‰Practice","count":153,"path":"api/categories/PATï¼ˆAdvanced-Levelï¼‰Practice.json"}],"tags":[{"name":"Cï¼‹ï¼‹","slug":"Cï¼‹ï¼‹","count":160,"path":"api/tags/Cï¼‹ï¼‹.json"},{"name":"Graph","slug":"Graph","count":16,"path":"api/tags/Graph.json"},{"name":"TSP","slug":"TSP","count":2,"path":"api/tags/TSP.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\"><span class=\"toc-text\">Input Specification:</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\"><span class=\"toc-text\">Output Specification:</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\"><span class=\"toc-text\">Sample Input:</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\"><span class=\"toc-text\">Sample Output:</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\"><span class=\"toc-text\">Î©</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\"><span class=\"toc-text\">ğŸ</span></a>","author":{"name":"Starlit Rover","slug":"blog-author","avatar":"https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcQWu4nWh5NV26rlAS5lR23iaundn5IVlV3EpYGNAdtnMObooQnk","link":"/","description":"Stroll in the starlit firmament~","socials":{"github":"https://github.com/StarlitRover","twitter":"https://twitter.com/Starlit_Rover","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"steam":{"icon":"/images/aurora/steam.svg","link":"https://steamcommunity.com/id/starlitrover/"}}}},"mapped":true,"prev_post":{"title":"ã€Œ1151ã€LCA in a Binary Tree","uid":"1e6798c1367bb43a43c504bc91548d12","slug":"ã€Œ1151ã€LCA-in-a-Binary-Tree","date":"2022-11-28T14:12:07.000Z","updated":"2022-11-28T14:29:58.570Z","comments":true,"path":"api/articles/ã€Œ1151ã€LCA-in-a-Binary-Tree.json","keywords":null,"cover":null,"text":"The lowest common ancestor (LCA) of two nodes U and V in a tree is the deepest node that has both U and V as descendants. Given any two node...","link":"","photos":[],"count_time":{"symbolsCount":"3.2k","symbolsTime":"3 mins."},"categories":[{"name":"PATï¼ˆAdvanced Levelï¼‰Practice","slug":"PATï¼ˆAdvanced-Levelï¼‰Practice","count":153,"path":"api/categories/PATï¼ˆAdvanced-Levelï¼‰Practice.json"}],"tags":[{"name":"Cï¼‹ï¼‹","slug":"Cï¼‹ï¼‹","count":160,"path":"api/tags/Cï¼‹ï¼‹.json"},{"name":"traversal order","slug":"traversal-order","count":13,"path":"api/tags/traversal-order.json"},{"name":"Tree","slug":"Tree","count":23,"path":"api/tags/Tree.json"}],"author":{"name":"Starlit Rover","slug":"blog-author","avatar":"https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcQWu4nWh5NV26rlAS5lR23iaundn5IVlV3EpYGNAdtnMObooQnk","link":"/","description":"Stroll in the starlit firmament~","socials":{"github":"https://github.com/StarlitRover","twitter":"https://twitter.com/Starlit_Rover","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"steam":{"icon":"/images/aurora/steam.svg","link":"https://steamcommunity.com/id/starlitrover/"}}}}},"next_post":{"title":"ã€1149ã€Dangerous Goods Packaging","uid":"ff3134335de30a822a5e1c46f95fdfc6","slug":"ã€1149ã€Dangerous-Goods-Packaging","date":"2022-11-28T10:26:29.000Z","updated":"2022-11-28T14:36:11.446Z","comments":true,"path":"api/articles/ã€1149ã€Dangerous-Goods-Packaging.json","keywords":null,"cover":null,"text":"When shipping goods with containers, we have to be careful not to pack some incompatible goods into the same container, or we might get ours...","link":"","photos":[],"count_time":{"symbolsCount":"3k","symbolsTime":"3 mins."},"categories":[{"name":"PATï¼ˆAdvanced Levelï¼‰Practice","slug":"PATï¼ˆAdvanced-Levelï¼‰Practice","count":153,"path":"api/categories/PATï¼ˆAdvanced-Levelï¼‰Practice.json"}],"tags":[{"name":"Cï¼‹ï¼‹","slug":"Cï¼‹ï¼‹","count":160,"path":"api/tags/Cï¼‹ï¼‹.json"},{"name":"bitset","slug":"bitset","count":4,"path":"api/tags/bitset.json"}],"author":{"name":"Starlit Rover","slug":"blog-author","avatar":"https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcQWu4nWh5NV26rlAS5lR23iaundn5IVlV3EpYGNAdtnMObooQnk","link":"/","description":"Stroll in the starlit firmament~","socials":{"github":"https://github.com/StarlitRover","twitter":"https://twitter.com/Starlit_Rover","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"steam":{"icon":"/images/aurora/steam.svg","link":"https://steamcommunity.com/id/starlitrover/"}}}}}}